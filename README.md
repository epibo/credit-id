### 数字信用链与雄安数字身份公共服务平台间的交互需求					
					
* _（10月15日之前出接口的文档？）_

#### 一、交互接口需求					
* 备注：本次不给每个自然人分配独立的公私钥对、而是平台拥有一个公私钥对。每次上传信息时，平台可以使用拥有的私钥对信息签名后，并一起上传签名。					

> _**问题：哪个平台？机构的平台还是我们提供接口的平台？暂且认为是机构提供的（调用我们接口的）平台。**_


1. 注册流程					
（1）CID注册上链（CID的标识上链）					
in：CID、个人信息字符串					
out:状态码。200成功					

> _**改：提交个人信息（字符串），返回 CID。**_


2. 认证流程					
（1）认证记录上链（认证操作，操作本身编码后上链）					
in：CID、记录					
out:状态码。200成功					

> _**问题：是什么认证？是什么操作？要如何编码？需不需要验证编码（checksum）？  
 改：参数增加一个签名，我们接口或Ont区块链要验签（具体视Ont文档情况而定）。**_


3. 凭证签发					
（1）凭证提供机构注册上链（凭证提供机构的公钥地址上链）					
in:凭证提供机构ID、公钥数组					
out：状态码。200成功					

> _**改（两种方案）：
 a. 提交公钥数组，返回`机构 ID`（因为是注册）；  
 b. 提交`机构 ID`（预先分配），公钥数组和对各个公钥的自签名（证明每一个私钥都有）。  
 暂定方案 b。**_


（2）获取凭证注册时凭证编号对应的公钥对（凭证编号是凭证提供机构的编号）					
in：凭证提供机构ID					
out：凭证对应公钥数组					

> _**问题：  
 a. `凭证编号`和`机构 ID`是什么关系？暂且认为二者相同；  
 b. “公钥对”？暂且认为是公钥数组。  
（对参数无异议）。**_


（3）新签发的凭证，明文哈希和凭证上链。（新的凭证的哈希和明文上链，并返回凭证的链上ID。
凭证的内容中包含有凭证的有效期、凭证所属的CID和其他属性，这里只需要关心其中的有效期和CID属性）					
in：CID、凭证提供机构ID、凭证指纹、凭证明文、凭证有效期					
out：状态码；凭证的链上ID					

> _**问题：凭证指的是什么？公钥数组？  
 改：提交对凭证的签名（如果是公钥数组，就提交对各个公钥的自签名），不需要指纹哈希。**_


（4）注销凭证（将指定链上ID对应的凭证状态置为失效）					
in：凭证的链上ID、					
out：状态码					

> _**改：还需提交对凭证 ID 的签名，以确保该操作是授权的。**_


4. 凭证使用					
（1）验证凭证时，向链查验凭证状态（根据输入的链上ID，返回凭证的有效状态：有效、不存在、已失效。并同时返回凭证的明文）					
in：凭证的链上ID，凭证提供机构签名（对随机数签名，随机数由链这边生成，后提供给公共服务平台）					
out：凭证状态、凭证指纹、凭证明文					

> _**问题：凭证明文作什么用途？  
 改：提交对所有参数拼接后的签名，参数包括随机数，由我们接口提供（先访问获取随机数接口，可表明随机数用途），保留会话 session；  
 返回值不需要指纹。**_


#### 二、数字信用链系统内部的功能需求（该部分需求可根据实际需要选择实施或用其它方式实施）					
					
1. 维持一个 CID 到凭证的对应关系；  
  a. CID 的添加；  
  b. 通过 CID 查到凭证列表；  
  c. 通过凭证查到 CID。					

2. 同时提供凭证的存证和凭证的状态核验功能；  
  A、凭证的添加；  
  B、凭证的状态查询；  
  C、根据凭证的有效期智能合约控制凭证状态。
					
3. 维持 CID 到认证记录的关系；  
  A、可以通过 CID，查到认证记录列表。					
					
备注：CID 是自然的身份 ID。每个凭证都是属于某一个 CID 的。					

> _**以上交互接口并未体现 CID 与其它数据的对用关系。所以交互接口是否设计有问题？**_
